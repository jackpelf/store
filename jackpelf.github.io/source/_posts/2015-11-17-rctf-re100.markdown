---
layout: post
title: "rctf-re100"
date: 2015-11-17 00:16:05 +0800
comments: true
categories: 
---

RE100

    signed int __cdecl check(int p)
    {
      int j; // [sp+0h] [bp-14h]@4
      int tmp; // [sp+4h] [bp-10h]@4
      int i; // [sp+8h] [bp-Ch]@1
      int sum; // [sp+Ch] [bp-8h]@1
    
      sum = 0;
      for ( i = 0; i <= 1024 && *(_DWORD *)(4 * i + p); i = sum * (sum + 1) / 2 )
      {
        tmp = 0;
        for ( j = 0; j <= sum; ++j )
          tmp += *(_DWORD *)(4 * (j + i) + p);
        if ( 1 << sum != tmp )
          return -1;
        ++sum;
      }
      return sum;
    }
这个函数是判断输入是否符合1，3，6，10中间隔是否是2的n次幂，

    signed int __cdecl check2(int p, signed int n)
    {
      int j; // [sp+10h] [bp-10h]@2
      int tmp; // [sp+14h] [bp-Ch]@2
      signed int i; // [sp+18h] [bp-8h]@1
      int sum; // [sp+1Ch] [bp-4h]@1
    
      sum = 0;
      for ( i = 1; i < n; ++i )
      {
        tmp = 0;
        j = i - 1;
        if ( !*(_DWORD *)(4 * i + p) )
          return 0;
        while ( n - 1 > j )
        {
          tmp += *(_DWORD *)(4 * (j * (j + 1) / 2 + sum) + p);
          ++j;
        }
        if ( *(_DWORD *)(4 * (j * (j + 1) / 2 + i) + p) != tmp )
          return 0;
        ++sum;
      }
      return 1;
    }
这个判断是否是杨辉三角，网上找了个杨辉三角的脚本，输出20行再md5即可


