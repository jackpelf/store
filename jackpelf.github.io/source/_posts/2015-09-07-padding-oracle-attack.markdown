---
layout: post
title: "padding oracle attack"
date: 2015-09-07 16:24:10 +0800
comments: true
categories: 
---

###0x00  PCKS#5
PCKS#5填充方式是明文的最后一个数据块填充需要填充的数据个数

###0x01 返回值
填充正确，包含合法值，返回200
填充正确，包含非法值，返回200
填充错误，  抛出异常，返回500

###0x02 加密与解密过程
加密

    初始化向量        |------------>向量  
       |              |              |
       |异或 原文     |              |异或 原文
       V              |              V
    中间值            |            中间值
       |              |              |
       |加密          |              |加密
       V              |              V
    密文--------------             密文  

      


解密

      密文--------------------                    密文
       |                     |                     |                
       |解密                 |                     |解密            
       V                     |                     V                
    中间值                   |                  中间值              
       |                     |                     |                
       |异或初始化向量       |-------->初始化向量  |异或
       V                                           V
     原文                                         原文


###0x03 攻击

给予初始化向量，产生合法的的尾部，可以推断出中间值最后一个字节，
将初始化向量最后一个字节改成异或得到的中间值最后一个字节为0x02的值，暴力破解倒数第二个字节
得到中间值

更改单个数据块原文为任意值，原文异或中间值得到初始化向量
