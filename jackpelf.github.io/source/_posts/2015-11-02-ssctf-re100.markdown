---
layout: post
title: "ssctf-re100"
date: 2015-11-02 21:50:49 +0800
comments: true
categories: 
---
###0x00 ssctf re100

经过分析可以调试到此处


    0040172B   . 68 DC304000    PUSH mfcEncry.004030DC                   ;  ASCII "R05WTE+v6r7ozfa4zsWjZ2RnZA=="
    00401730   . E8 91030000    CALL <JMP.&MFC42.#537>
    00401735   . 57             PUSH EDI
    00401736   . E8 95FAFFFF    CALL mfcEncry.004011D0
    0040173B   . 83C4 0C        ADD ESP,0C
    0040173E   . 8D4D E8        LEA ECX,DWORD PTR SS:[EBP-18]
    00401741   . 51             PUSH ECX
    00401742   . E8 69FEFFFF    CALL mfcEncry.004015B0
    00401747   . 8B00           MOV EAX,DWORD PTR DS:[EAX]
    00401749   . 8B4E 64        MOV ECX,DWORD PTR DS:[ESI+64]
    0040174C   . 50             PUSH EAX                                 ; /s2
    0040174D   . 51             PUSH ECX                                 ; |s1
    0040174E   . FF15 D4214000  CALL DWORD PTR DS:[<&MSVCRT._mbscmp>]    ; \_mbscmp
    00401754   . 83C4 10        ADD ESP,10
    00401757   . 8D4D E8        LEA ECX,DWORD PTR SS:[EBP-18]
    0040175A   . 85C0           TEST EAX,EAX

查看栈

    0018F794   00312E38  |s1 = "1111122222333334444"
    0018F798   00312ED8  \s2 = "HOWMP半块西瓜皮hehe"
    0018F79C   0018F7B4
    0018F7A0   00312ED8
    
即可看到key

