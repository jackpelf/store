from num import *
'''
m^e % n == c
c^d % n == m

set c, d, n
'''
def knownpqe(p,q,e,c):
	n = p*q
	fin = (p - 1) * (q - 1)
	d = modInv(e, fin)
	m = pow(c, d, n)
	print hex(m)[2:-1].decode('hex')
	return hex(m)[2:-1].decode('hex')
def knowncdn(c,d,n):
	m = pow(c, d, n)
	print hex(m)[2:-1].decode('hex')
	return hex(m)[2:-1].decode('hex')
p = 9733382803370256893136109840971590971460094779242334919432347801491641617443615856221168611138933576118196795282443503609663168324106758595642231987245583
q = 9733382803370256893136109840971590971460094779242334919432347801491641617443615856221168611138933576118196795282443503609663168324106758595642231987246769
e = 0x010001
c = 0x474bd14d040069f5beae32eee3ebdde453ad1512490c57e4f51d5bb2295a31767fa9a55bfcfd202073962fda4765e99bb75ecb3eafa2cb362ba143a7468cf705dff5b2f4c0b3db9c9637dc67b8bae73a70c8b7e7d89fb6e0a1ed16cb1745538efd5d11ffc0f2749b059a3ca1cef9331b1e0596be5731112df93ff865e78d6130
knownpqe(p,q,e,c)

f = open('almost_almost_almost_there.encrypted')
c = int(f.read().encode('hex'), 16)
q = 9733382803370256893136109840971590971460094779242334919432347801491641617443615856221168611138933576118196795282443503609663168324106758595642231987246769
n = 0xABE633CEC2E7EC10A851927905A657DF4E10416023C0C34FC64D64BD8B8257B7BF207ADD047B0ADF21C525B052068C70295C746C3B1BE1436F39ED8BF7A813E4B845CE0CA89CA828B45763D46B1898C7A2FA5F8FE78428CAB6CDF70EF871DB971B3232841A1CE2459CE650A154362F80CFB64163C3CA63AD72BCFBDBF0154FF7
p = n/q
knownpqe(p,q,e,c)


f = open('almost_almost_there.encrypted')
c = int(f.read().encode('hex'), 16)
n = 0xBAD20CF97ED5042DF696CE4DF3E5A678CF4FB3693D3DF12DFE9FD3FD8CC8AAB8B95533E414E3FC0C377F4EE54827118B1D30561A3C741BEA7C76899789B51743E076092DF9EB05DC97EB1505CE9EB12B5AB9E10ABF56F920A58E7E00ECF05977E872834DD8584CF4AC87CB7DC50159BD962C75CBEFB6C6AC3A31A74E7D8F1E4C10D5
q = 0
l = primet(100000)
for i in l:
	if (n%i) == 0:
		q = i
		break
knownpqe(n/q,q,e,c)

#level 4
f = open('almost_there.encrypted')
c = int(f.read().encode('hex'), 16)
e = 0x466A169E8C14AC89F39B5B0357EFFC3E2139F9B19E28C1E299F18B54952A07A932BA5CA9F4B93B3EAA5A12C4856981EE1A31A5B47A0068FF081FA3C8C2C546FEAA3619FD6EC7DD71C9A2E75F1301EC935F7A5B744A73DF34D21C47592E149074A3CCEF749ECE475E3B6B0C8EECAC7C55290FF148E9A29DB8480CFE2A57801275
p =  10114792273660656874618568712406420344176220457790563178092222929337786916374923318745284718351487926620784106195715878875311958793629905453919697155685507
q =  10843221374140991753173625949764386011485161421520044246309105053489500519257941272796681417497061734054081478280518835582353321569961722963922828311576983
knownpqe(p,q,e,c)
